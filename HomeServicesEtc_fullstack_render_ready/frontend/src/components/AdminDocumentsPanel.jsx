import React, { useEffect, useState } from "react";
export default function AdminDocumentsPanel(){ const [items,setItems]=useState([]); const [loading,setLoading]=useState(false);
  async function fetchPending(){ setLoading(true); const res = await fetch('/api/admin/documents/pending',{credentials:'include'}); if(res.ok){ const j=await res.json(); setItems(j);} setLoading(false); }
  useEffect(()=>{ fetchPending(); },[]);
  async function handleAction(id,action){ const expiry_date = action==='approve' ? prompt('Enter expiry date (YYYY-MM-DD) or leave blank:') : null; const notes = prompt('Notes (optional):')||''; const res = await fetch(`/api/admin/documents/${id}/verify`,{method:'POST',credentials:'include',headers:{'Content-Type':'application/json'},body:JSON.stringify({action,expiry_date,notes})}); if(res.ok){ alert('Updated'); fetchPending(); } else alert('Failed'); }
  return (<div style={{padding:12}}><h2>Admin Documents Panel</h2>{loading && <div>Loading...</div>}<div style={{display:'grid',gridTemplateColumns:'1fr',gap:12}}>{items.map(it=> (<div key={it.id} style={{border:'1px solid #ddd',padding:10,display:'flex',gap:10}}><div style={{width:160}}><img src={it.signedUrl} alt='doc' style={{maxHeight:120,objectFit:'contain'}}/></div><div style={{flex:1}}><div><strong>Provider:</strong> {it.provider_email}</div><div><strong>Type:</strong> {it.doc_type}</div><div style={{marginTop:8}}><button onClick={()=>handleAction(it.id,'approve')} style={{marginRight:6}}>Approve</button><button onClick={()=>handleAction(it.id,'reject')} style={{marginRight:6}}>Reject</button><button onClick={()=>handleAction(it.id,'suspend')}>Suspend</button></div></div></div>))}</div></div>); }
